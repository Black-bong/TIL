# 스프링 입문강의
---
>인프런에서 김영한님의 스프링 입문강의를 보고 요약, 정리한 글입니다.
>
> `강의 내용외에 직접 검색하고, 찾아본 내용도 함께 작성될 수 있습니다.`
>>출처: https://www.inflearn.com/course/스프링-핵심-원리-기본편/dashboard
---
# 1.프로젝트 환경설정

## 라이브러리
### 웹관련
- tomcat
    - 톰캣(웹서버)
- webmvc
    - 스트링 웹 mvc
    - https://docs.spring.io/spring-boot/docs/2.6.2-SNAPSHOT/reference/htmlsingle/#web.servlet.spring-mvc
    - Spring docs을 보면 간단한 예제와 더욱 자세한 설명을 볼 수 있는 링크가 있으니 꼭 한번 보자
### 로그관련
- logback
    - 성능도 좋고 여러 지원하는 기능이 많아 요즘 많이 사용
- slf4j
    - 구현체의 전환을 통해 다른 로깅 프레임워크로 전환이 쉽다.
### 테스트관련
- junit5
    - 대부분 이걸사용
    - https://junit.org/junit5/docs/current/user-guide/
- mockito
    - 목 라이브러리
    - Java 용 오픈 소스 테스트 프레임 워크
## View설정
### Welcome Page
- `static/index.html` 을 올려두면 Welcom page 기능이 작동되어 index.html을 화면에 띄어준다.
- [https://docs.spring.io/spring-boot/docs/2.6.1/reference/htmlsingle/#web.servlet.spring-mvc.welcome-page](https://docs.spring.io/spring-boot/docs/2.6.1/reference/htmlsingle/#web.servlet.spring-mvc.welcome-page)
### thymeleaf
- 템플릿 엔진
- [https://docs.spring.io/spring-boot/docs/2.6.1/reference/htmlsingle/#web.servlet.spring-mvc.template-engines](https://docs.spring.io/spring-boot/docs/2.6.1/reference/htmlsingle/#web.servlet.spring-mvc.template-engines)

## controller
- webapplication에서의 첫번째 진입점
- `@Controller` 어노테이션 사용
    
    ```java
    @Controller
    public class HelloController {
    
      @GetMapping("hello")
      public String hello(Model model) {
        model.addAttribute("data", "hello!");
        return	"hello";
      }
    }
    ```   
    - 컨트롤러에서 리턴 값으로 문자를 반환하면 뷰 리졸버가 화면을 찾아서 처리한다.
    - `model.addAttribute("data", "hello")` → 모델의 data값으로 hello!를 추가
## 빌드하고 실행하기
1. 콘솔로 이동
2. `./gralew build` 입력
3. `cd build/libs` 입력
4. `java -jar hello-spring-0.0.1-SNAPSHOT.jar` 입력
5. 실행 확인
6. 잘안되면 `./gradlew clean build` 입력해서 `build`를 초기화하고 다시 처음부터 해보기
# 2.스프링 웹 개발 기초
### 정적컨텐츠
- 내장 톰켓서버에서 스프링 컨테이너에 `.html` 관련 컨트롤러가 있는지 확인 후 없으면 `resources/static`안에서 찾아보고 있으면 그대로 반환
- [https://docs.spring.io/spring-boot/docs/2.6.1/reference/htmlsingle/#web.servlet.spring-mvc.static-content](https://docs.spring.io/spring-boot/docs/2.6.1/reference/htmlsingle/#web.servlet.spring-mvc.static-content)
### MVC와 템플릿 엔진
- Controller
- Model    
    ```java
    @Controller
    public class HelloController {
    
      @GetMapping("hello")
      public String hello(Model model) {
        model.addAttribute("data", "hello!");
        return	"hello";
      }
      @GetMapping("hello-mvc")
      public String helloMvc(@RequestParam("name") String name, Model model) {
        model.addAttribute("name", name);
        return "hello-template"
      }
    }
    ```    
- View   
    `resources/template/hellp-template.html`    
    ```html
    <html xmlns:th="http://www.thymeleaf.org">
      <body>
        <p th:text="'hello ' + ${name}">hello! empty</p>
      </body>
    </html>
    ...
    ```  
    - parameter(ex:localhost:8080/hello-mvc?name=Spring!!)로 name을 넘겨주면 model에서(name:spring) viewResolver로 값을 넘겨 화면 출력
    - 화면 출력은 Thymeleaf 템플릿 엔진이 처리
    ### API
```java
@Controller
public class HelloController {

    @GetMapping("hello-string")
    @ResponseBody
    public String helloString(@RequestParam("name") String name) {
        return "hello" + name; // "hello spring"
    }
}
```
- `@ResponseBody` : HTTP통신 프로토콜 응답BODY부에 직접 데이터를 넣어주겠다는 표시의 어노테이션
- view이런거 없이 return 되는 문자 그대로 출력됨.
- 이대로 사용되는 일은 거의 없다.
```java
@Controller
public class HelloController {

    @GetMapping("hello-api")
    @ResponseBody
    public Hello helloApi(@RequestParam("name") String name) {
        Hello hello = new Hello();
        hello.setName(name);
        return hello;
    }

    static class Hello {
        private String name;

        public String getName() {
            return name;
        }
        public void setName(String name) {
            this.name = name;
        }
    }
}
```
- 리턴을 문자가 아닌 객체를 리턴하였다.
- 문자를 리턴하면 문자 그대로 출력되고, 소스를 봐도 문자만 출력되지만 객체를 리턴 할 경우 json형식으로 출력되지만.
- `{"name":"spring!!!!!!"}` 키`:`값 형태의 json형식
- spring프로젝트에서는 json형식으로 반환하는것이 디폴트, 다른형식으로 변경은 가능하다(xml등등)
### `@ResponseBody` 사용원리
- HTTP의 BODY에 문자 내용을 직접 반환
- `viewResolver` 대신에 `HttpMessageConverter` 가 동작한다.
- 기본 문자처리: `StringHttpMessageConverter` 가 동작.
- 기본 객체처리: `MappingJackson2HttpMessageConverter` 가 동작.
    - Jackson2: 객체를 json으로 변환해주는 대표적인 라이브러리중 하나(스프링 기본 설정)
    - [https://docs.spring.io/spring-boot/docs/2.6.2-SNAPSHOT/reference/htmlsingle/#features.json.jackson](https://docs.spring.io/spring-boot/docs/2.6.2-SNAPSHOT/reference/htmlsingle/#features.json.jackson)
