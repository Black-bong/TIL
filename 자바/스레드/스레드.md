# 자바에서의 스레드

## 스레드의 구현

### Thread 클래스를 상속
```java
class ThreadTest extends Thread {
    @Override
    public void run() {
        ...
    }
}
```
- 스레드 생성
```java
ThreadTest th = new ThreadTest();
th.start();
```
- 스레드 실행
### Runnable 인터페이스를 구현
```java
class RunnableTest implements Runnable {
    @Override
    public void run() {
    ...
    }
}
```
- Runnable을 사용한 스레드 생성
```java
Thread th = new Thread(new RunnableTest());
th.start();
```
- Runnable을 사용한 스레드 실행

## 스레드의 실행

### start()메서드
```java
Thread th1 = new Thread();
Thread th2 = new Thread();

th1.start();
th2.start();
```
- 스레드를 생성한 후에 start()메서드를 호출해야 스레드가 작업을 시작한다.
- 스레드의 실행순서는 기본적으로 보장되지 않는다.
- 스레드의 실행순서는 OS의 스케줄러에 의해 결정된다.

## main스레드
- main()메서드의 코드를 실행하는 스레드
- 실행중인 사용자 스레드가 하나도 없을때 프로그램은 종료된다.

### join()메서드
- 어떤 스레드가 작업이 종료될때 까지 스레드의 작업을 지연시킬수 있는 메서드

## 스레드의 우선순위
- 작업의 중요도에 따라 스레드의 우선순위를 다르게 하여 특정 스레드가 더 많은 작업시간을 갖게 할 수 있다.

### 스레드의 우선순위 설정
```java
void setPriority(int new Priority); // 스레드의 우선 순위 설정
int getPriortiy(); // 스레드의 우선 순위 반환

public static final int MAX_PRIORITY = 10; // 최대 우선 순위
public static final int MAX_PRIORITY = 5;  // 보통 우선 순위
public static final int MAX_PRIORITY = 1;  // 최소 우선 순위 
```
- 우선순위가 높을수록 더 많은 작업 시간을 갖는다.
- 여기서 설정하는 우선순위는 희망사항 일뿐 결국 OS의 스케줄러에 따라 우선 순위가 결정된다.

## 스레드 그룹
- 서로 관련된 스레를 그룹으로 묶어서 다루기 위한 것
- 모든 스레드는 반드시 하나의 스레드 그룹에 포함되어 있어야 한다.
- 스레드 그룹을 지정하지 않고, 생성한 스레드는 main스레드 그룹에 속한다.
- 자신을 생성한 스레드의 그룹과 우선순위를 상속받는다.

### 스레드 그룹의 메서드
|메서드|설명|
|----|----|
|int activeCount()|스레드 그룹에 포함된 활성상태의 스레드의 수를 반환|
|int activeGroupCount()|스레드 그룹에 포함된 활성상태의 스레드 그룹의 수를 반환|
|void checkAccess()|현재 실행중인 스레드가 스레드 그룹을 변경할 권한이 있는지 체크|
|void destroy()|스레드 그룹과 하위 그룹까지 모두 삭제(그룹이 비어있어야 가능)|
|int getMaxPriority()|스레드 그룹의 최대 운선순위를 반환|
|String getName()|스레드 그룹의 이름을 반환|
|ThreadGroup getParent()|스레드 그룹의 상위 스레드 그룹을 반환|
|void interrupt()|스레드 그룹에 속한 모든 스레드를 인터럽트 한다|
|boolean isDaemon()|스레드 그룹이 데몬 스레드 그룹인지 확인|
|boolean isDestroyed()|스레드 그룹이 삭제되었는지 확인|
|void list()|스레드 그룹에 속한 스레드와 하위 스레드 그룹에 대한 정보 출력|
|boolean parentOf(ThreadGroup g)|지정된 스레드 그룹의 상위 스레드 그룹인지 확인|
|void setDaemon(boolean daemon)|스레드 그룹을 데몬 스레드 그룹으로 설정 또는 해제|
|void setMaxPriority(int pri)|스레드 그룹의 최대 우선순위를 설정|
- 등등 메서드가 존재하며, 필요할때 찾아서 사용

## 데몬 스레드
- 일반 스레드의 작업을 돕는 보조적인 역할을 수행하는 스레드
- 일반 스레드가 종료되면, 자동으로 종료된다.
- GC, 자동저장, 화면 자동갱신 등에 사용한다.

### 데몬 스레드의 생성
- 무한루프와 조건문을 이용해서 실행 후 대기하다가 특정 조건이 만족되면 작업을 다시 수행하고, 다시 대기하도록 작성한다.
```java
...
@Override
public void run() {
    while (true) {
        try {
            Thread.sleep(3000);
        } catch (InturruptedExcption e) {
            ...
        }
        if (autoSave) {
            autoSave();
        }
    }
}
```
- 일반 스레드가 종료되면, 자동으로 종료되기 때문에 무한루프로 생성해도 상관이 없다.
- setDaemon()은 반드시 start()를 호출하기 전에 실행되어야 한다. 그렇지 않으면 IllegalThreadStateException이 발생한다.